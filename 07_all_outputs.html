<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>All Outputs - BMW Sales Forecast</title>
<style>body{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:20px} h2{margin-top:1.2rem} figure{margin:12px 0} img{max-width:100%;height:auto;border:1px solid #ddd;padding:4px;background:#fff} .filelink{margin-bottom:8px;display:inline-block}</style>
</head>
<body>
<h1>BMW Sales Forecast ‚Äî Generated Outputs</h1>
<p>Repository path: C:\Users\easts\github\bmw-sales-forecast</p>
<h2>PNG Visualizations</h2>
<figure><figcaption>01_sales_overview.png</figcaption><img src="01_sales_overview.png" alt="01_sales_overview.png"/></figure>
<figure><figcaption>02_model_region_heatmap.png</figcaption><img src="02_model_region_heatmap.png" alt="02_model_region_heatmap.png"/></figure>
<figure><figcaption>03_arima_forecast.png</figcaption><img src="03_arima_forecast.png" alt="03_arima_forecast.png"/></figure>
<figure><figcaption>04_model_forecasts.png</figcaption><img src="04_model_forecasts.png" alt="04_model_forecasts.png"/></figure>
<h2>Interactive HTML Outputs</h2>
<div class="filelink"><a href="05_interactive_dashboard.html" target="_blank">Open 05_interactive_dashboard.html in new tab</a></div>
<div style="margin:12px 0; border:1px solid #ccc;"><iframe src="05_interactive_dashboard.html" style="width:100%;height:640px;border:0"></iframe></div>
<div class="filelink"><a href="06_model_heatmap_interactive.html" target="_blank">Open 06_model_heatmap_interactive.html in new tab</a></div>
<div style="margin:12px 0; border:1px solid #ccc;"><iframe src="06_model_heatmap_interactive.html" style="width:100%;height:640px;border:0"></iframe></div>
</body>
</html>
# Generate Aggregator HTML - All Outputs in One Place
import webbrowser
from IPython.display import IFrame, HTML
import glob

print("\n" + "="*80)
print("üìä GENERATING AGGREGATOR HTML")
print("="*80)

# Output file name
out_html = '07_all_outputs.html'

# Files to exclude from aggregator
exclude_names = {out_html, 'commit_messages-can-change-values.html'}

# Scan for PNG and HTML files
pngs = sorted([f for f in glob.glob('*.png')])
htmls = sorted([f for f in glob.glob('*.html') if f not in exclude_names])

print(f"\nFound {len(pngs)} PNG files:")
for p in pngs:
    print(f"  ‚Ä¢ {p}")

print(f"\nFound {len(htmls)} HTML files:")
for h in htmls:
    print(f"  ‚Ä¢ {h}")

# Build aggregator HTML
html_content = f"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMW Sales Forecast - Complete Report</title>
    <style>
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        body {{
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }}
        .container {{
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }}
        header {{
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }}
        header h1 {{
            font-size: 2.5em;
            margin-bottom: 10px;
        }}
        header p {{
            font-size: 1.1em;
            opacity: 0.95;
        }}
        .nav {{
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #ddd;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }}
        .nav a {{
            display: inline-block;
            padding: 8px 16px;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: all 0.3s ease;
        }}
        .nav a:hover {{
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }}
        main {{
            padding: 40px 30px;
        }}
        section {{
            margin-bottom: 50px;
        }}
        section h2 {{
            font-size: 1.8em;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }}
        .gallery {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }}
        .image-card {{
            background: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }}
        .image-card:hover {{
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }}
        .image-card img {{
            width: 100%;
            height: 350px;
            object-fit: cover;
            display: block;
        }}
        .image-card .caption {{
            padding: 15px;
            text-align: center;
            font-weight: 500;
            color: #555;
            background: white;
        }}
        .iframe-wrapper {{
            background: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }}
        .iframe-wrapper iframe {{
            width: 100%;
            height: 600px;
            border: none;
            display: block;
        }}
        footer {{
            background: #f8f9fa;
            padding: 25px 30px;
            text-align: center;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.95em;
        }}
        .timestamp {{
            display: block;
            margin-top: 10px;
            font-size: 0.9em;
            color: #999;
        }}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó BMW Sales Forecast Analysis</h1>
            <p>Complete Analytics Report & Visualizations</p>
        </header>
        
        <nav class="nav">
            <a href="#overview">üìä Overview</a>
            <a href="#dashboards">üìà Interactive Dashboards</a>
            <a href="#top">‚Üë Back to Top</a>
        </nav>
        
        <main>
            <!-- PNG Images Section -->
            <section id="overview">
                <h2>üìä Static Visualizations</h2>
                <div class="gallery">
"""

# Add PNG images
for png_file in pngs:
    safe_name = png_file.replace('.png', '').replace('_', ' ').title()
    html_content += f"""
                    <div class="image-card">
                        <img src="{png_file}" alt="{safe_name}">
                        <div class="caption">{safe_name}</div>
                    </div>
"""

html_content += """
                </div>
            </section>
            
            <!-- HTML Files Section -->
            <section id="dashboards">
                <h2>üìà Interactive Dashboards</h2>
"""

# Add HTML files as iframes
for html_file in htmls:
    safe_name = html_file.replace('.html', '').replace('_', ' ').title()
    html_content += f"""
                <div>
                    <h3 style="margin-top: 30px; color: #555; margin-bottom: 10px;">‚Üí {safe_name}</h3>
                    <div class="iframe-wrapper">
                        <iframe src="{html_file}" title="{safe_name}"></iframe>
                    </div>
                </div>
"""

html_content += """
            </section>
        </main>
        
        <footer>
            <p>BMW Sales Forecasting & Alert System</p>
            <p>Generated by: Advanced Analytics Pipeline</p>
            <span class="timestamp">Report generated on """ + datetime.now().strftime('%Y-%m-%d %H:%M:%S') + """</span>
        </footer>
    </div>
    
    <!-- Colab Fallback: Open in New Tab -->
    <script>
        // For Google Colab: Try to open in a new tab if iframe loading fails
        if (typeof google !== 'undefined' && google.colab) {
            window.open(window.location.href, '_blank');
        }
    </script>
</body>
</html>
"""

# Write aggregator HTML
with open(out_html, 'w') as f:
    f.write(html_content)

print(f"\n‚úÖ Created: {out_html}")

# Open in browser
try:
    webbrowser.open(f'file://{os.path.abspath(out_html)}')
    print(f"‚úÖ Opened in browser")
except Exception as e:
    print(f"‚ö†Ô∏è Could not open browser: {e}")

# Display inline in Colab and VS Code notebooks
print(f"\nüì∫ Displaying aggregator HTML inline:")
try:
    display(IFrame(src=out_html, width=1000, height=800))
except:
    # Fallback for non-Jupyter environments
    print(f"   (Open {out_html} in your browser manually)")

print("\n" + "="*80)
print("‚úÖ AGGREGATOR HTML COMPLETE - All outputs compiled!")
print("="*80)